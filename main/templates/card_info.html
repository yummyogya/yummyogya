<div class="card relative">
    <img src="{{ item.gambar }}" alt="{{ item.nama }}" class="object-cover w-full h-48">

    <!-- Tombol Add to Wishlist -->
    <div class="absolute top-4 right-2">
        <button 
            onclick="addToWishlist('{{ item.id }}')"
            class="relative flex w-8 h-8 justify-center items-center bg-white text-white hover:bg-gray-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 text-center dark:bg-white dark:hover:bg-gray-600 dark:focus:ring-green-800">
            <svg fill="#000000" version="1.1" class="absolute w-6 h-6"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512">
                <g>
                    <path d="M294.957,478.609c-27.619,0-50.087-22.468-50.087-50.087c0-9.223-7.479-16.696-16.696-16.696H16.696
                    C7.479,411.826,0,419.299,0,428.522C0,474.554,37.446,512,83.478,512h211.478c9.217,0,16.696-7.473,16.696-16.696
                    C311.652,486.082,304.174,478.609,294.957,478.609z"/>
                </g>
                <g>
                    <path d="M510.239,209.576l-33.391-66.783c-2.826-5.658-8.608-9.228-14.935-9.228s-12.109,3.571-14.935,9.228l-33.391,66.783
                    c-1.152,2.321-1.761,4.875-1.761,7.467v16.696H512v-16.696C512,214.451,511.391,211.897,510.239,209.576z"/>
                </g>
                <g>
                    <path d="M411.826,445.217v16.696c0,27.619,22.468,50.087,50.087,50.087C489.532,512,512,489.532,512,461.913v-16.696H411.826z"/>
                </g>
                <g>
                    <path d="M428.522,0H150.261c-46.032,0-83.478,37.446-83.478,83.478v294.956h161.391c27.619,0,50.087,22.468,50.087,50.087
                    c0,9.206,7.49,16.696,16.696,16.696c27.569,0,49.99,22.39,50.072,49.94c20.239-15.246,33.406-39.401,33.406-66.636V100.174h116.87
                    c9.217,0,16.696-7.473,16.696-16.696C512,37.446,474.554,0,428.522,0z M150.261,333.913c-9.22,0-16.696-7.475-16.696-16.696
                    s7.475-16.696,16.696-16.696s16.696,7.475,16.696,16.696S159.481,333.913,150.261,333.913z M150.261,267.13
                    c-9.22,0-16.696-7.475-16.696-16.696c0-9.22,7.475-16.696,16.696-16.696s16.696,7.475,16.696,16.696
                    C166.957,259.655,159.481,267.13,150.261,267.13z M150.261,200.348c-9.22,0-16.696-7.475-16.696-16.696
                    c0-9.22,7.475-16.696,16.696-16.696s16.696,7.475,16.696,16.696C166.957,192.873,159.481,200.348,150.261,200.348z
                    M150.261,133.565c-9.22,0-16.696-7.475-16.696-16.696s7.475-16.696,16.696-16.696s16.696,7.475,16.696,16.696
                    S159.481,133.565,150.261,133.565z M294.957,333.913h-77.913c-9.217,0-16.696-7.473-16.696-16.696
                    c0-9.223,7.479-16.696,16.696-16.696h77.913c9.217,0,16.696,7.473,16.696,16.696C311.652,326.44,304.174,333.913,294.957,333.913z
                    M294.957,267.13h-77.913c-9.217,0-16.696-7.473-16.696-16.696c0-9.223,7.479-16.696,16.696-16.696h77.913
                    c9.217,0,16.696,7.473,16.696,16.696C311.652,259.657,304.174,267.13,294.957,267.13z M294.957,200.348h-77.913
                    c-9.217,0-16.696-7.473-16.696-16.696c0-9.223,7.479-16.696,16.696-16.696h77.913c9.217,0,16.696,7.473,16.696,16.696
                    C311.652,192.875,304.174,200.348,294.957,200.348z M294.957,133.565h-77.913c-9.217,0-16.696-7.473-16.696-16.696
                    c0-9.223,7.479-16.696,16.696-16.696h77.913c9.217,0,16.696,7.473,16.696,16.696C311.652,126.092,304.174,133.565,294.957,133.565
                    z M381.293,66.783c6.892-19.435,25.456-33.391,47.229-33.391c21.772,0,40.337,13.956,47.229,33.391H381.293z"/>
                </g>
            </svg>
        </button>
    </div>

    <div class="card-body p-4">
        <h3 class="text-lg font-semibold">{{ item.nama }}</h3>
        <p>{{ item.deskripsi }}</p>
        <p class="price font-bold mt-2">Harga: Rp {{ item.harga }}</p>
        <p class="restoran">Restoran: {{ item.restoran }}</p>
        <p>Rating: {{ item.rating }} / 5</p>
    </div>

    <script>
    function getCsrfToken() {
        const cookieValue = document.cookie
            .split('; ')
            .find(row => row.startsWith('csrftoken'))
            ?.split('=')[1];
        return cookieValue;
    }
    
    function addToWishlist(foodId) {
        console.log(foodId)
        fetch(`/wishlist/add/${foodId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': getCsrfToken(),  // Ambil CSRF token di sini
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ food_id: foodId })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            const wishlistCounter = document.getElementById('wishlist-counter');
            if (wishlistCounter && data.wishlist_count !== undefined) {
                wishlistCounter.textContent = data.wishlist_count;
            } else {
                alert('Item added to wishlist!');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to add to wishlist. Please try again.');
        });
    }
    
    </script>
</div>


